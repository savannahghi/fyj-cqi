{% extends 'dqa/index_dqa.html' %}
{% load crispy_forms_tags %}
{% load static %}


{% block content %}
<main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
 <h6 class="display-6 text-primary text-center">DQA DASHBOARD</h6>
<hr>
    <div class="p-5 mb-4 bg-light rounded-3">

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-info col-12" role="alert">
        <h5 class="small">{{ message }}</h5>
    </div>

        {% endfor %}
{% endif %}
      {% if "facility" in title %}
      <h6 class="display-6 fw-bold text-primary">CREATE FACILITY QI</h6>
      {% elif "program" in title %}
          <h6 class="display-6 fw-bold text-primary">CREATE {{ title|upper }} QI</h6>
      {% endif %}
    <div class="d-flex justify-content-around mb-3">
        {% if dqa_type == "hub" %}
        <a href="{% url 'dqa_dashboard' dqa_type='hub' %}" class="btn btn-success">HUB DQA</a>
            {% else %}
        <a href="{% url 'dqa_dashboard' dqa_type='hub' %}" class="btn btn-outline-success">HUB DQA</a>
            {% endif %}
            {% if dqa_type == "subcounty" %}
        <a href="{% url 'dqa_dashboard' dqa_type='subcounty' %}" class="btn btn-success">SUB-COUNTIES DQA</a>
                 {% else %}
        <a href="{% url 'dqa_dashboard' dqa_type='subcounty' %}" class="btn btn-outline-success">SUB-COUNTIES DQA</a>
    {% endif %}
    {% if dqa_type == "county" %}
          <a href="{% url 'dqa_dashboard' dqa_type='county' %}" class="btn btn-success">COUNTY DQA</a>
        {% else %}
          <a href="{% url 'dqa_dashboard' dqa_type='county' %}" class="btn btn-outline-success">COUNTY DQA</a>
    {% endif %}
    {% if dqa_type == "program" %}
         <a href="{% url 'dqa_dashboard' dqa_type='program' %}" class="btn btn-success">PROGRAM DQA</a>
        {% else %}
         <a href="{% url 'dqa_dashboard' dqa_type='program' %}" class="btn btn-outline-success">PROGRAM DQA</a>
        {% endif %}
     </div>
      <form class="row g-3" method="POST" class="mt-5" enctype='multipart/form-data' autocomplete="off">
        {% csrf_token %}
        <p> Please choose quarter, year and then submit </p>

        <div class="col-md-3 mt-2">
            {{ quarter_form.quarter|as_crispy_field }}
        </div>
        <div class="col-md-3 mt-2 pr-5">
            {{ year_form.year|as_crispy_field }}
        </div>
        {% if dqa_type == "subcounty" %}
            <div class="col-md-4 mt-2">
                {{ subcounty_form.subcounty |as_crispy_field }}
            </div>
          {% elif dqa_type == "county" %}
            <div class="col-md-4 mt-2">
                {{ county_form.county |as_crispy_field }}
            </div>
          {% elif dqa_type == "hub" %}
            <div class="col-md-4 mt-2">
                {{ hub_form.hub |as_crispy_field }}
            </div>
        {% elif dqa_type == "program" %}
            <div class="col-md-4 mt-2">
                {{ program_form.program |as_crispy_field }}
            </div>
        {% endif %}
          <div class="col-md-2 mt-2 pt-3">
            <input class="btn btn-success mt-1" type="submit"  value="Submit">
        </div>
      </form>

    {% if viz %}
          <hr>
      <h6 class="text-primary text-center">{{ quarter_year }} Overall DQA Activities</h6>
          <hr>

          <div class="col-md-12 d-flex">
                        <div class="col-md-4">
                             {{ county_viz|safe }}
                        </div>
                        <div class="col-md-8">
                            {{ hub_viz|safe }}
                        </div>
                    </div>
           <div class="col mt-3" >
            {{ sub_county_viz|safe }}
        </div>
          <div class="col mt-3" >
            {{ viz|safe }}
        </div>
      {% endif %}
    {% if charts %}


          <hr>
      <h6 class="text-primary text-center">System Assessment</h6>
          <hr>
      <div class="col mt-3" >
          <table class="table table-striped table-hover" style="font-size: x-small;">
      <thead class="thead-dark text-center">
          <tr>
              <th colspan="2" >COLOUR CODE KEY</th>
          </tr>
        <tr>
          <th>Color code</th>
          <th>Range</th>
        </tr>
      </thead>
      <tbody>

       <tr>
            <td class="text-center text-black" style="background-color: green; border: 1px solid black;">
                        <strong>Green</strong>
                        </td>
            <td class="text-primary text-center">
               <strong> >= 2.5</strong>
            </td>

        </tr>
      <tr>
            <td class="text-center text-black" style="background-color: yellow; border: 1px solid black;">
                        <strong>Yellow</strong>
                        </td>
            <td class="text-primary text-center">
              <strong> >= 1.5 and < 2.5</strong>
            </td>

          <tr>
            <td class="text-center text-black" style="background-color: red; border: 1px solid black;">
                        <strong>Red</strong>
                        </td>
            <td class="text-primary text-center">
               <strong> < 1.5</strong>
            </td>

        </tr>
        </tr>
      </tbody>
    </table>
            {{ system_assessment_viz|safe }}
        </div>
    {% for chart in charts %}
         <div class="col mt-3" >
            {{ chart|safe }}
        </div>

    {% endfor %}
    {% endif %}
{% if dicts %}



      <hr>
      <h6 class="text-primary text-center">Data Verification</h6>
          <hr>
      <div class="row" >
      {% if dicts %}
               <p class="text-center text-primary" >
                   The DQA summary charts below are ordered from the indicators with the greatest discrepancies to the least.
               </p>

                {% for indicator,fig in dicts.items %}
                          <div class="col-md-4 mt-3" >
                            <div class="card">
                                <div class="col">
                                    <div class="text text-center">
                                        {{ indicator }}
                                    </div>
                                    <div class="row" >
                                        <div class="chart-container">{{ fig|safe }}</div>
                                    </div>
                                </div>
                            </div>
                          </div>
                {% endfor %}
            {% endif %}
      </div>
    {% endif %}
    {% if audit_team %}
        <hr>
    <h6 class="text-primary text-center">Audit Team <span class="badge bg-success" data-bs-toggle="tooltip"
                                                  title="Number of YELLOW scores. Click to view">{{ audit_team_df|length }}</span>
        </h6>
        <hr>

{#      <table class="table table-striped table-hover" style="font-size: x-small;">#}
{#      <thead class="thead-dark text-center">#}
{#        <tr>#}
{#            <th></th>#}
{#          <th>Name (First and Last name)</th>#}
{#          <th>Carder</th>#}
{#          <th>Organization</th>#}
{#          <th>Facility</th>#}
{#          <th>Review Period</th>#}
{#            <th></th>#}
{#        </tr>#}
{#      </thead>#}
{#      <tbody>#}
{#        {% for team in audit_team %}#}
{#        <tr>#}
{#        <td><strong>{{ forloop.counter}}</strong></td>#}
{#            <td class="text-center text-black">#}
{#                       {{ team.name }}#}
{#            </td>#}
{#            <td class="text-center text-black">#}
{#               {{ team.carder }}#}
{#            </td>#}
{#            <td class="text-center text-black">#}
{#               {{ team.organization }}#}
{#            </td>#}
{#            <td class="text-center text-black">#}
{#               {{ team.facility_name.name }}#}
{#            </td>#}
{#        {% for facility in audit_team %}#}
{#            {% if  facility.facility_name.name in team.facility_name.name %}#}
{#                <td class="text-center text-black">#}
{#                    {{ facility.facility_name.name }}#}
{#                </td>#}
{#            {% endif %}#}
{#            {% endfor %}#}
{#            <td class="text-center text-black">#}
{#               {{ team.quarter_year.quarter_year }}#}
{#            </td>#}
{#        <td><a href="{% url 'update_audit_team' team.id %}" class="btn btn-info" role="button">Update</a></td>#}
{#        {% if not team.hide_update_button or request.user.is_superuser %}#}
{#            <td class="text-center">#}
{#                <a href="{% url 'update_audit_team' team.id %}" class="btn btn-info" role="button">Update</a>#}
{#            </td>#}
{#        {% endif %}#}
{#        </tr>#}
{#        {% endfor %}#}
{#      </tbody>#}
{#    </table>#}
                    <table class="table table-striped table-hover">
  <thead class="thead-dark">
  <th scope="col"></th>
  {% for col in audit_team_df.columns %}
      <th scope="col">{{ col }}</th>
  {% endfor %}
  </thead>
  <tbody>
   </tr>
    {% for index, row in audit_team_df.iterrows %}
      <tr>
          <th scope="row">{{ index}}</th>
        {% for cell in row %}
          <td>
            {{cell}}
          </td>
        {% endfor %}
      </tr>
    {% endfor %}


  </tbody>
</table>
      {% endif %}

{#{% if system_assessments %}#}
{#<table class="table table-striped table-hover" style="font-size: x-small;">#}
{#  <thead class="thead-dark text-center">#}
{#    <tr>#}
{#      <th>#</th>#}
{#      <th>Component of the M&E System <span class="text-warning">(I - M&E Structure, Functions and Capabilities)</span> </th>#}
{#        <th>Answer</th>#}
{#        <th>Calculations</th>#}
{#      <th>Auditor Note</th>#}
{#      <th>Supporting Documentation Required</th>#}
{#        <th></th>#}
{#    </tr>#}
{#  </thead>#}
{#  <tbody>#}
{#    {% for form in system_assessments|slice:":5" %}#}
{#      <tr>#}
{#        <td>{{ forloop.counter }}</td>#}
{#        <td>{{ form.description }}</td>#}
{#      {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{#          {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{##}
{#            <td>{{ form.auditor_note }}</td>#}
{#            <td>{{ form.supporting_documentation_required }}</td>#}
{#      <td><a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a></td>#}
{#      {% if not form.hide_update_button or request.user.is_superuser %}#}
{#    <td class="text-center">#}
{#        <a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a>#}
{#    </td>#}
{#      {% endif %}#}
{#      </tr>#}
{#    {% endfor %}#}
{#   <tr>#}
{#        <td></td>#}
{#        <td class="fw-bold">#}
{#            Average#}
{#        </td>#}
{#        <td></td>#}
{#            {% for key,value in average_dictionary.items %}#}
{#                {% if key == "average_calculations_5" %}#}
{#                    {% if value >= 2.5 %}#}
{#                        <td class="text-center text-black" style="background-color: green">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value >= 1.5 and value < 2.5 %}#}
{#                        <td class="text-center text-black" style="background-color: yellow">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value < 1.5 %}#}
{#                        <td class="text-center text-black" style="background-color: red">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% else %}#}
{#                        <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% endif %}#}
{#                {% endif %}#}
{#            {% endfor %}#}
{##}
{#        <td></td>#}
{#        <td><strong>Denominator: </strong></td>#}
{#        <td>{% for key,value in expected_counts_dictionary.items %}#}
{#                {% if key == "average_calculations_5" %}#}
{#                    <strong>{{value}}</strong>#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        </td>#}
{#    </tr>#}
{#  </tbody>#}
{#<thead class="thead-dark text-center">#}
{#    <tr>#}
{#      <th>#</th>#}
{#      <th>Component of the M&E System <span class="text-warning">(II- Data Management Processes)</span> </th>#}
{#        <th>Answer</th>#}
{#        <th>Calculations</th>#}
{#      <th>Auditor Note</th>#}
{#      <th>Supporting Documentation Required</th>#}
{#        <th></th>#}
{#    </tr>#}
{#  </thead>#}
{#  <tbody>#}
{##}
{#  {% for form in system_assessments|slice:"5:12" %}#}
{#      <tr>#}
{#        <td>{{ forloop.counter|add:5 }}</td>#}
{#        <td>{{ form.description }}</td>#}
{#      {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{#          {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{##}
{#            <td>{{ form.auditor_note }}</td>#}
{#            <td>{{ form.supporting_documentation_required }}</td>#}
{#      <td><a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a></td>#}
{# {% if not form.hide_update_button or request.user.is_superuser %}#}
{#    <td class="text-center">#}
{#        <a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a>#}
{#    </td>#}
{#      {% endif %}#}
{#      </tr>#}
{#    {% endfor %}#}
{#    <tr>#}
{#        <td></td>#}
{#        <td class="fw-bold">Average</td>#}
{#        <td></td>#}
{#            {% for key,value in average_dictionary.items %}#}
{#                {% if key == "average_calculations_5_12" %}#}
{#                    {% if value >= 2.5 %}#}
{#                        <td class="text-center text-black" style="background-color: green">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value >= 1.5 and value < 2.5%}#}
{#                        <td class="text-center text-black" style="background-color: yellow">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value < 1.5 %}#}
{#                        <td class="text-center text-black" style="background-color: red">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% else %}#}
{#                        <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% endif %}#}
{#                {% endif %}#}
{#            {% endfor %}#}
{##}
{#        <td></td>#}
{#        <td><strong>Denominator: </strong></td>#}
{#        <td>{% for key,value in expected_counts_dictionary.items %}#}
{#                {% if key == "average_calculations_5_12" %}#}
{#                    <strong>{{value}}</strong>#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        </td>#}
{#    </tr>#}
{#  </tbody>#}
{#<thead class="thead-dark text-center">#}
{#    <tr>#}
{#      <th>#</th>#}
{#      <th>Component of the M&E System <span class="text-warning">(III- Indicator Definitions and Reporting Guidelines)</span> </th>#}
{#        <th>Answer</th>#}
{#        <th>Calculations</th>#}
{#      <th>Auditor Note</th>#}
{#      <th>Supporting Documentation Required</th>#}
{#        <th></th>#}
{#    </tr>#}
{#  </thead>#}
{##}
{#  <tbody>#}
{##}
{#  {% for form in system_assessments|slice:"12:17" %}#}
{#      <tr>#}
{#        <td>{{ forloop.counter|add:12 }}</td>#}
{#        <td>{{ form.description }}</td>#}
{#      {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{#          {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{##}
{#            <td>{{ form.auditor_note }}</td>#}
{#            <td>{{ form.supporting_documentation_required }}</td>#}
{#      <td><a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a></td>#}
{#       {% if not form.hide_update_button or request.user.is_superuser %}#}
{#    <td class="text-center">#}
{#        <a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a>#}
{#    </td>#}
{#      {% endif %}#}
{#      </tr>#}
{#    {% endfor %}#}
{#  <tr>#}
{#        <td></td>#}
{#        <td class="fw-bold">Average</td>#}
{#        <td></td>#}
{#            {% for key,value in average_dictionary.items %}#}
{#                {% if key == "average_calculations_12_17" %}#}
{#                    {% if value >= 2.5 %}#}
{#                        <td class="text-center text-black" style="background-color: green">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value >= 1.5 and value < 2.5%}#}
{#                        <td class="text-center text-black" style="background-color: yellow">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value < 1.5 %}#}
{#                        <td class="text-center text-black" style="background-color: red">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% else %}#}
{#                        <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% endif %}#}
{#                {% endif %}#}
{#            {% endfor %}#}
{##}
{#        <td></td>#}
{#        <td><strong>Denominator: </strong></td>#}
{#        <td>{% for key,value in expected_counts_dictionary.items %}#}
{#                {% if key == "average_calculations_12_17" %}#}
{#                    <strong>{{value}}</strong>#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        </td>#}
{#    </tr>#}
{#  </tbody>#}
{#<thead class="thead-dark text-center">#}
{#    <tr>#}
{#      <th>#</th>#}
{#      <th>Component of the M&E System <span class="text-warning">(IV- Data-collection and Reporting Forms / Tools)</span> </th>#}
{#        <th>Answer</th>#}
{#        <th>Calculations</th>#}
{#      <th>Auditor Note</th>#}
{#      <th>Supporting Documentation Required</th>#}
{#        <th></th>#}
{#    </tr>#}
{#  </thead>#}
{#<tbody>#}
{##}
{#  {% for form in system_assessments|slice:"17:21" %}#}
{#      <tr>#}
{#        <td>{{ forloop.counter|add:17 }}</td>#}
{#        <td>{{ form.description }}</td>#}
{#      {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{#          {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{##}
{#            <td>{{ form.auditor_note }}</td>#}
{#            <td>{{ form.supporting_documentation_required }}</td>#}
{#      <td><a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a></td>#}
{#       {% if not form.hide_update_button or request.user.is_superuser %}#}
{#    <td class="text-center">#}
{#        <a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a>#}
{#    </td>#}
{#      {% endif %}#}
{#      </tr>#}
{#    {% endfor %}#}
{#<tr>#}
{#        <td></td>#}
{#        <td class="fw-bold">Average</td>#}
{#        <td></td>#}
{#            {% for key,value in average_dictionary.items %}#}
{#                {% if key == "average_calculations_17_21" %}#}
{#                    {% if value >= 2.5 %}#}
{#                        <td class="text-center text-black" style="background-color: green">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value >= 1.5 and value < 2.5%}#}
{#                        <td class="text-center text-black" style="background-color: yellow">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value < 1.5 %}#}
{#                        <td class="text-center text-black" style="background-color: red">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% else %}#}
{#                        <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% endif %}#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        <td></td>#}
{#        <td><strong>Denominator: </strong></td>#}
{#        <td>{% for key,value in expected_counts_dictionary.items %}#}
{#                {% if key == "average_calculations_17_21" %}#}
{#                    <strong>{{value}}</strong>#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        </td>#}
{#    </tr>#}
{#  </tbody>#}
{#<thead class="thead-dark text-center">#}
{#    <tr>#}
{#      <th>#</th>#}
{#      <th>Component of the M&E System <span class="text-warning">(V- EMR Systems)</span> </th>#}
{#        <th>Answer</th>#}
{#        <th>Calculations</th>#}
{#      <th>Auditor Note</th>#}
{#      <th>Supporting Documentation Required</th>#}
{#        <th></th>#}
{#    </tr>#}
{#  </thead>#}
{#<tbody>#}
{# {% for form in system_assessments|slice:"21:25" %}#}
{#      <tr>#}
{#        <td>{{ forloop.counter|add:21 }}</td>#}
{#        <td>{{ form.description }}</td>#}
{#      {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.dropdown_option }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{#          {% if form.calculations == 3 %}#}
{#              <td class="text-center text-black" style="background-color: green">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 2 %}#}
{#              <td class="text-center text-black" style="background-color: yellow">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% elif form.calculations == 1 %}#}
{#              <td class="text-center text-black" style="background-color: red">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{#              {% else %}#}
{#              <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                    <strong>{{ form.calculations|floatformat:"0" }}</strong>#}
{#                </td>#}
{##}
{#          {% endif %}#}
{##}
{#            <td>{{ form.auditor_note }}</td>#}
{#            <td>{{ form.supporting_documentation_required }}</td>#}
{#      <td><a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a></td>#}
{#          {% if not form.hide_update_button or request.user.is_superuser %}#}
{#    <td class="text-center">#}
{#        <a href="{% url 'update_system_assessment' form.id %}" class="btn btn-info" role="button">Update</a>#}
{#    </td>#}
{#{% endif %}#}
{#      </tr>#}
{#    {% endfor %}#}
{#<tr>#}
{#        <td></td>#}
{#        <td class="fw-bold">Average</td>#}
{#        <td></td>#}
{#            {% for key,value in average_dictionary.items %}#}
{#                {% if key == "average_calculations_21_25" %}#}
{#                    {% if value >= 2.5 %}#}
{#                        <td class="text-center text-black" style="background-color: green">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value >= 1.5 and value < 2.5%}#}
{#                        <td class="text-center text-black" style="background-color: yellow">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% elif value < 1.5 %}#}
{#                        <td class="text-center text-black" style="background-color: red">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% else %}#}
{#                        <td class="text-center text-black" style="background-color: ghostwhite">#}
{#                        <strong>{{ value }}</strong>#}
{#                        </td>#}
{#                    {% endif %}#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        </td>#}
{##}
{#        <td></td>#}
{#        <td><strong>Denominator: </strong></td>#}
{#        <td>{% for key,value in expected_counts_dictionary.items %}#}
{#                {% if key == "average_calculations_21_25" %}#}
{#                    <strong>{{value}}</strong>#}
{#                {% endif %}#}
{#            {% endfor %}#}
{#        </td>#}
{#    </tr>#}
{##}
{#  </tbody>#}
{##}
{#</table>#}
{#      {% endif %}#}




{#      </div>#}
    </div>
</main>
{% endblock %}