{% load static %}
{% block navbar %}{% endblock %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.104.2">
    <title>USAID UON-FYJ {% block title %} {% endblock %}</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/dashboard/">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/footers/">
    <link href="{% static 'assets/dist/css/bootstrap.min.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'assets/fonts/icomoon/style.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/rome.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .b-example-divider {
            height: 3rem;
            background-color: rgba(0, 0, 0, .1);
            border: solid rgba(0, 0, 0, .15);
            border-width: 1px 0;
            box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        }

        .b-example-vr {
            flex-shrink: 0;
            width: 1.5rem;
            height: 100vh;
        }

        .bi {
            vertical-align: -.125em;
            fill: currentColor;
        }

        .nav-scroller {
            position: relative;
            z-index: 2;
            height: 2.75rem;
            overflow-y: hidden;
        }

        .nav-scroller .nav {
            display: flex;
            flex-wrap: nowrap;
            padding-bottom: 1rem;
            margin-top: -1px;
            overflow-x: auto;
            text-align: center;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        table {
            font-size: smaller;
        }

        nav {
            font-size: 10px;
        }

        form {
            font-size: 12px;
        }

        .btn {
            font-size: 10px;
            box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.2);
        }

        .card {
            font-size: 12px;
        }

        .form-control {
            font-size: small;
        }

        .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeeba;
        }

        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }

        .alert-danger {
            color: #f2f5f3;
            background-color: #c73c30;
            border-color: #bee5eb;
        }

        .alert-success {
            color: #f2f5f3;
            background-color: #4eed09;
            border-color: #bee5eb;
        }

        table {
            width: 100%;
        }

        .my-table {
            position: relative;
        {#z-index: 1; /* this will make the table appear above the navbar */#}
        }

        thead {
            background-color: #6c757d;
            color: #fff;
            position: sticky;
            top: 56px; /* this will make the table header stick 56px below the navbar */
            z-index: 1; /* ensure that the thead is above other table content */
        }

        .comments-card {
            max-width: 100%;
        }

        .sub-reply {
            padding-left: 100px;
        }

        .full-width-input {
            width: 100%;
        }

        {#    table td {#}
        {#    width: 1em;#}
        {#    height: 50px;#}
        {#    text-align: left;#}
        {#    vertical-align: top;#}
        {#padding: 10px;#}

        td {
        {#width: 50px;#}{#height: 20px;#} font-size: 12px;
        {#overflow: hidden;#}{#text-overflow: ellipsis;#}{#white-space: nowrap;#}
        }

        /* Add a class of animated to the element to be animated */
        .animated {
            /* Set the duration of the animation to 5 seconds */
            animation-duration: 5s;
            /* Make sure the element retains its state after the animation is complete */
            animation-fill-mode: both;
        }

        /* Define the keyframes of the fade-in animation */
        @keyframes fadeIn {
            /* Start the animation with the element having an opacity of 0 */
            from {
                opacity: 0;
            }
            /* End the animation with the element having an opacity of 1 */
            to {
                opacity: 1;
            }
        }

        /* Add a class of fadeIn to the element to trigger the fade-in animation */
        .fadeIn {
            /* Assign the fade-in animation to the element */
            animation-name: fadeIn;
        }


        .flicker-button {
            /* This selector is used to add style to the button element with the class name "flicker-button" */
            animation: flicker 5s infinite;
            /* The animation property is applied to the button with the value "flicker" for 1 second, with infinite repetition */
        }

        @keyframes flicker {
            /* The keyframes define the animation for the "flicker" animation */
            0% {
                background-color: green;
            }
            /* At 0% of the animation, the background color of the button is set to green */
            50% {
                background-color: red;
            }
            /* At 50% of the animation, the background color of the button is set to red */
            100% {
                background-color: green;
            }
            /* At 100% of the animation, the background color of the button is set back to green */
        }

        textarea[name="description"] {
            background-color: grey;
        }

        .chart-container {
        {#height: 300px; /* adjust to your desired height */#} width: 100%; /* make the chart take up the full width of the container */
        }
    </style>

    <!-- Custom styles for this template -->
    <link href="{% static 'dashboard.css' %}" rel="stylesheet">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>

    <!-- Fengyuan Chen's Datepicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datepicker/0.6.5/datepicker.min.css"
          integrity="sha256-b88RdwbRJEzRx95nCuuva+hO5ExvXXnpX+78h8DjyOE=" crossorigin="anonymous"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datepicker/0.6.5/datepicker.min.js"
            integrity="sha256-/7FLTdzP6CfC1VBAj/rsp3Rinuuu9leMRGd354hvk0k=" crossorigin="anonymous"></script>
</head>
{% block top_nav %}{% endblock %}
<body>
<!-- BODY -->
<div class="container-fluid">
    <div class="row">
        {% block content %} {% endblock %}
    </div>
</div>
<!-- JS SCRIPTS -->
<script src="{% static 'assets/dist/js/bootstrap.bundle.min.js' %}"></script>

<script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"
        integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
        integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha"
        crossorigin="anonymous"></script>
<script src="{% static 'dashboard.js' %}"></script>
<script>
    $(function () {
        $("#id_start_date").datepicker();
        $("#id_end_date").datepicker();
        $("#id_due_date").datepicker();
        $("#id_month_year").datepicker();
        $("#id_dqa_date").datepicker();
        $("#id_due_complete_by").datepicker();
        $("#id_collection_date_gte").datepicker();
        $("#id_collection_date_lte").datepicker();

    });
</script>

<script>
    let navbar = document.getElementById("navbar");
    let navbarHeight = navbar.offsetHeight;
    let table = document.getElementsByClassName("my-table")[0];
    table.style.marginTop = navbarHeight + 'px';
</script>

<!--This enables searching and filtering the dropdown-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/js/select2.min.js"></script>
<script>
    $(document).ready(function () {
        $('.select2').select2();
    });
</script>

<script>
    // Get references to the fields
    const receivedStatusField = document.querySelector('#id_received_status');
    const dateOfTestingField = document.querySelector('#id_date_of_testing');
    const cd4CountResultsField = document.querySelector('#id_cd4_count_results');
    const cd4PercentageField = document.querySelector('#id_cd4_percentage');
    const tbLamResultsField = document.querySelector('#id_tb_lam_results');
    const serumCragResultsField = document.querySelector('#id_serum_crag_results');
    const reasonNoSerumCragField = document.querySelector('#id_reason_for_no_serum_crag');
    const ageField = document.querySelector('#id_age');
    const rejectionReasonField = document.querySelector('#id_reason_for_rejection');

    // Function to enable or disable the cd4_percentage field
    function toggleCd4Percentage() {
        const receivedStatus = receivedStatusField.value;
        const age = parseFloat(ageField.value);

        if (receivedStatus === "Rejected" || (receivedStatus === "Accepted" && age > 5) || age > 5) {
            cd4PercentageField.disabled = true;
            cd4PercentageField.value = "";
        } else {
            cd4PercentageField.disabled = false;
        }
    }

    // Call the function on page load
    toggleCd4Percentage();

    // Bind the function to the change event of the age and receivedStatus fields
    ageField.addEventListener('change', toggleCd4Percentage);
    receivedStatusField.addEventListener('change', toggleCd4Percentage);


    // Function to enable or disable the date_of_testing field
    function toggleFieldsUponRejection() {
        const receivedStatus = receivedStatusField.value;

        if (receivedStatus === 'Rejected') {
            [dateOfTestingField, cd4CountResultsField, tbLamResultsField, cd4PercentageField, serumCragResultsField,
                reasonNoSerumCragField].forEach(field => {
                field.disabled = true;
                field.value = "";
            });
        } else {
            [dateOfTestingField, cd4CountResultsField, tbLamResultsField, cd4PercentageField, serumCragResultsField,
                reasonNoSerumCragField].forEach(field => {
                field.disabled = false;
            });
            // Enable cd4PercentageField if the conditions are met
            toggleCd4Percentage();
            {#toggleCragField();#}
        }
    }

    // Call the function on page load
    toggleFieldsUponRejection();

    // Bind the function to the change event of the received_status field
    receivedStatusField.addEventListener('change', toggleFieldsUponRejection);

    // Function to enable or disable the reason_for_rejection field
    function toggleRejectionReason() {
        if (receivedStatusField.value === 'Accepted') {
            rejectionReasonField.disabled = true;
            rejectionReasonField.value = "";
        } else {
            rejectionReasonField.disabled = false;
        }
    }

    // Call the function on page load
    toggleRejectionReason();

    // Bind the function to the change event of the received_status field
    receivedStatusField.addEventListener('change', toggleRejectionReason);

    {#// Function to enable or disable the serum_crag_results field#}
    {#function toggleCragField() {#}
    {#    const cd4CountValue = cd4CountResultsField.value;#}
    {##}
    {#    if (cd4CountValue !== "" && parseFloat(cd4CountValue) > 200) {#}
    {#        serumCragResultsField.disabled = true;#}
    {#        serumCragResultsField.value = "";#}
    {#        reasonNoSerumCragField.disabled = true;#}
    {#        reasonNoSerumCragField.value = "";#}
    {#        tbLamResultsField.disabled = true;#}
    {#        tbLamResultsField.value = "";#}
    {#    } else {#}
    {#        serumCragResultsField.disabled = false;#}
    {#        tbLamResultsField.disabled = false;#}
    {#        reasonNoSerumCragField.disabled = false;#}
    {#    }#}
    //}
    {##}
    {#// Call the function on page load#}
    {#toggleCragField();#}
    {##}
    {#// Bind the function to the change event of the cd4_count_results field#}
    {#cd4CountResultsField.addEventListener('change', toggleCragField);#}

    // Function to enable or disable the reason_for_no_serum_crag field
    function toggleNoCragReason() {
        const cd4CountValue = cd4CountResultsField.value;
        if (serumCragResultsField.value !== "" && parseFloat(cd4CountValue) <= 200) {
            reasonNoSerumCragField.disabled = true;
            reasonNoSerumCragField.value = "";
        } else {
            reasonNoSerumCragField.disabled = false;
            // Enable reasonNoSerumCragField if the conditions are met
            {#toggleCragField()#}
        }
    }

    // Call the function on page load
    toggleNoCragReason();

    // Bind the function to the change event of the received_status field
    serumCragResultsField.addEventListener('change', toggleNoCragReason);
</script>

<!-- Show uploaded files dynamically -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const fileInput = document.querySelector('input[type="file"]');
        const fileList = document.getElementById('uploaded-files-list');
        const uploadedFilesLabel = document.querySelector('#uploaded-files-label');

        // Function to update the file list
        function updateFileList() {
            let fileNames = '';
            for (let i = 0; i < fileInput.files.length; i++) {
                fileNames += '<li>' + fileInput.files[i].name + '</li>';
            }
            fileList.innerHTML = fileNames;

            // Show/hide label based on uploaded files
            uploadedFilesLabel.style.display = fileInput.files.length > 0 ? 'block' : 'none';
        }

        // Update file list on file selection
        fileInput.addEventListener('change', function () {
            updateFileList();
        });
    });
</script>
<script>
    // This script is designed to toggle the visibility of the summary section
    // when the "Show/Hide Summary" button is clicked.
    $(document).ready(function () {
        // Attach the click event to the toggle buttons
        $('#toggleSummaryTop, #toggleSummaryBottom').on('click', function () {
            // Toggle the visibility of the summary section
            $('#collapse_summary').toggleClass('show');
            // Update the label text based on visibility
            updateLabel();
        });

        // Function to update the label text
        function updateLabel() {
            // Get the label element associated with the toggle buttons
            const label = $('#toggleSummaryTop, #toggleSummaryBottom').next('.form-check-label');
            // Check if the summary section is visible
            const isVisible = $('#collapse_summary').hasClass('show');
            // Update the label text accordingly
            label.text(isVisible ? 'Hide Summary' : 'Show Summary');
        }
    });
</script>


<script>
    /// This script is designed to reset the form when the document is fully loaded
    document.addEventListener("DOMContentLoaded", () => {
        const filterForm = document.getElementById('filter-form');

        // Array of fields to be reset
        const fieldsToReset = ['#id_county', '#id_sub_county', '#id_facility_name', '#id_testing_laboratory',
            '#id_haart_class', '#id_sequence_summary'];

        // Function to reset the form
        const resetForm = () => {
            // Reset the form fields
            filterForm.reset();

            // Clear the values in specific fields using select2
            fieldsToReset.forEach((field) => {
                $(field).val(null).trigger('change.select2');
                $(field).select2('destroy').select2();
            });
        };

        // Attach the resetForm function to the reset button click event
        document.getElementById('reset-button').addEventListener('click', (event) => {
            event.preventDefault(); // Prevent the default form submission
            resetForm(); // Call the resetForm function
        });
    });

</script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var sequenceSummaryField = document.getElementById("id_sequence_summary");
        var fileFields = document.getElementById("id_files");
        var patientUniqueNoInput = document.getElementById("id_patient_unique_no");

        // Initial check and hide/show based on the initial value
        checkSequenceSummaryValue();

        // Attach an event listener to sequence_summary field to check and update visibility
        sequenceSummaryField.addEventListener("change", checkSequenceSummaryValue);

        function checkSequenceSummaryValue() {
            var sequenceSummaryValue = sequenceSummaryField.value;

            // Check if the value is "FAILED"
            if (sequenceSummaryValue === "FAILED") {
                // Hide the files input
                fileFields.style.display = "block";
                document.getElementById("files-input").style.display = "none";
                document.getElementById("patient-unique-input").style.display = "block";
                // Make the files input not required
                fileFields.removeAttribute("required");
                patientUniqueNoInput.setAttribute("required", "required");
            } else {
                // Show the files input
                fileFields.style.display = "block";
                document.getElementById("files-input").style.display = "block";
                document.getElementById("patient-unique-input").style.display = "none";
                // Make the files input required
                fileFields.setAttribute("required", "required");
                patientUniqueNoInput.removeAttribute("required");
            }
        }
    });
</script>



{% block footer %}{% endblock %}
</body>
</html>